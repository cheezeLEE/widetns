<?xml version="1.0" encoding="UTF-8"?>

<!-- DTD 선언 -->
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
	<mapper namespace="com.widetns.projmp.dao.ProjmpDAO">
	
	<!-- 프로젝트 목록 조회 -->
	<select id="projList" resultType="hashmap">
		SELECT pb.prj_name, pb.pm_name, pb.prj_start, pb.prj_end 
		FROM project_mapping pm 
			JOIN project_basic pb ON pb.prj_num = pm.prj_num
			JOIN employee e ON pm.emp_num = e.emp_num
		WHERE pb.deleted_yn = 'n'
		GROUP BY pb.prj_name;
	</select>

	<!-- 사원 목록 조회 -->
	<select id="empList" resultType="hashmap">
		SELECT * FROM employee
	</select>
	
	<!-- 사원 정보 상세보기 페이지 -->
	<select id="empDetail" resultType="hashmap">
		SELECT * FROM employee WHERE emp_num = 1
	</select>
	
	<!-- 사원 정보 수정 -->
	<update id="empUpdate" parameterType="hashmap">
		UPDATE employee SET 
			addr1 = #{addr1}, addr2 = #{addr2}, addr3 = #{addr3}, pos = #{pos}, dept = #{dept},
			career = #{career}, emp_level = #{emp_level}, cert = #{cert}
		WHERE emp_num = 1
	</update>
	
	<insert id="insertImg" parameterType="hashmap">
		INSERT INTO emp_img(uuid, uploadpath, filename, emp_num)
		VALUES(#{uuid}, #{uploadPath}, #{fileName}, #{emp_num})
	</insert>
	
	<select id="findImg" resultType="hashmap">
		SELECT * FROM emp_img WHERE empNo = #{empNo}
	</select>
</mapper>